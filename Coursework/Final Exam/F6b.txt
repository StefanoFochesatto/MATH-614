>> A = magic(5)

A =

    17    24     1     8    15
    23     5     7    14    16
     4     6    13    20    22
    10    12    19    21     3
    11    18    25     2     9

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

>> H1 = hessen(A, true)

This is stage:1
    17    24     1     8    15
    23     5     7    14    16
     4     6    13    20    22
    10    12    19    21     3
    11    18    25     2     9

This is stage:2
   17.0000  -28.9413   -3.1787   -2.4469    3.5084
  -27.6767   33.9399  -20.5149  -12.9517  -10.1857
    0.0000  -18.8471    8.6867   12.5188   14.0439
    0.0000  -11.5283   11.2626    9.9119   -8.5139
    0.0000  -11.9043   16.1713  -10.9908   -4.5386

This is stage:3
   17.0000  -28.9413    1.8470   -1.1284    4.8699
  -27.6767   33.9399   26.1875   -0.6996    2.4660
    0.0000   25.0964   20.6871    1.7669    6.3679
    0.0000         0    1.4221    3.6837  -14.0463
    0.0000   -0.0000    5.7909  -17.4796  -10.3107

This is stage:4
   17.0000  -28.9413    1.8470   -4.4603    2.2572
  -27.6767   33.9399   26.1875   -2.2280    1.2675
    0.0000   25.0964   20.6871   -6.6055   -0.1973
    0.0000         0   -5.9630  -16.8163  -12.4454
    0.0000   -0.0000   -0.0000   -9.0122   10.1893


H1 =

   17.0000  -28.9413    1.8470   -4.4603    2.2572
  -27.6767   33.9399   26.1875   -2.2280    1.2675
    0.0000   25.0964   20.6871   -6.6055   -0.1973
    0.0000         0   -5.9630  -16.8163  -12.4454
    0.0000   -0.0000   -0.0000   -9.0122   10.1893

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

>> H = hess(A)

H =

   17.0000  -28.9413    1.8470   -4.4603    2.2572
  -27.6767   33.9399   26.1875   -2.2280    1.2675
         0   25.0964   20.6871   -6.6055   -0.1973
         0         0   -5.9630  -16.8163  -12.4454
         0         0         0   -9.0122   10.1893

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

>> norm((H - H1),2)

   3.1283e-14
